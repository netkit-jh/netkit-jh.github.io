(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{105:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return u})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return d}));var a=n(3),i=n(7),o=(n(0),n(194)),l=n(202),r=n(203),c={id:"usingtmux",title:"Using Tmux With Netkit-JH",sidebar_label:"Using Tmux"},u={unversionedId:"usingtmux",id:"version-1.1.3/usingtmux",isDocsHomePage:!1,title:"Using Tmux With Netkit-JH",description:"Installing Tmux",source:"@site/versioned_docs/version-1.1.3/tmux.mdx",slug:"/usingtmux",permalink:"/docs/1.1.3/usingtmux",editUrl:"https://github.com/netkit-jh/netkit-jh.github.io/edit/main/versioned_docs/version-1.1.3/tmux.mdx",version:"1.1.3",sidebar_label:"Using Tmux",sidebar:"version-1.1.3/docsSidebar",previous:{title:"Introduction Lab",permalink:"/docs/1.1.3/introduction"},next:{title:"Getting Started with Netkit Development",permalink:"/docs/1.1.3/dev/gettingstarted"}},s=[{value:"Installing Tmux",id:"installing-tmux",children:[]},{value:"Configure Netkit to use Tmux",id:"configure-netkit-to-use-tmux",children:[{value:"Netkit.conf",id:"netkitconf",children:[]},{value:"Commandline Arguments",id:"commandline-arguments",children:[]}]},{value:"How Use Tmux with Netkit-JH",id:"how-use-tmux-with-netkit-jh",children:[{value:"Connecting To A Machine",id:"connecting-to-a-machine",children:[]},{value:"General Tmux Use",id:"general-tmux-use",children:[]},{value:"Disconnecting from a machine",id:"disconnecting-from-a-machine",children:[]},{value:"Show Help Message",id:"show-help-message",children:[]},{value:"The Netkit VM Pane",id:"the-netkit-vm-pane",children:[]},{value:"Creating New Panes",id:"creating-new-panes",children:[]},{value:"Creating new windows",id:"creating-new-windows",children:[]},{value:"Capturing Output",id:"capturing-output",children:[]},{value:"Netkit Machine Shutdown / Failure",id:"netkit-machine-shutdown--failure",children:[]}]},{value:"Advanced",id:"advanced",children:[]}],b={toc:s};function d(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"installing-tmux"},"Installing Tmux"),Object(o.b)("p",null,"Tmux is available in most package managers - install with your package manager:"),Object(o.b)(l.a,{defaultValue:"deb",values:[{label:"Debian / Ubuntu",value:"deb"},{label:"Arch Linux",value:"arch"}],mdxType:"Tabs"},Object(o.b)(r.a,{value:"deb",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"$ sudo apt install tmux\n"))),Object(o.b)(r.a,{value:"arch",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"$ sudo pacman -S tmux\n")))),Object(o.b)("h2",{id:"configure-netkit-to-use-tmux"},"Configure Netkit to use Tmux"),Object(o.b)("p",null,"There are two ways to enable tmux with Netkit-JH: through netkit.conf, or through commandline arguments to ",Object(o.b)("inlineCode",{parentName:"p"},"lstart")," or ",Object(o.b)("inlineCode",{parentName:"p"},"vstart"),"."),Object(o.b)("h3",{id:"netkitconf"},"Netkit.conf"),Object(o.b)("p",null,"Edit the file at ",Object(o.b)("inlineCode",{parentName:"p"},"$NETKIT_HOME/netkit.conf")," and look for the following options:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"USE_TMUX=FALSE\nTMUX_OPEN_TERMS=FALSE\n")),Object(o.b)("p",null,"USE_TMUX specifies whether to start the Netkit VM in a tmux session or not. This takes a value of 'TRUE' or 'FALSE', however if the option given is invalid, the behaviour will default to tmux being disabled."),Object(o.b)("p",null,"TMUX_OPEN_TERMS specifies whether a terminal should be automatically opened for the machine after the tmux session is created. This means at the end of the machine startup script, the ",Object(o.b)("inlineCode",{parentName:"p"},"vconnect")," command is run to attempt to connect to the tmux session in a new terminal. This will use the terminal specified by TERM_TYPE in your config. This will retry every 5 seconds, up to 20 times. If no tmux session exists by then, it will fail. TMUX_OPEN_TERMS can have a value of 'TRUE' or 'FALSE', however if the option given is invalid the behaviour will default to it being disabled. When TMUX_OPEN_TERMS is TRUE, you must be running the ",Object(o.b)("inlineCode",{parentName:"p"},"lstart")," / ",Object(o.b)("inlineCode",{parentName:"p"},"vstart")," command within a graphical environment, as it will attempt to open a graphical terminal. If it is FALSE, you can still connect manually with ",Object(o.b)("inlineCode",{parentName:"p"},"vconnect -m MACHINE")," - which is useful if you are running headless, for example through an SSH session."),Object(o.b)("h3",{id:"commandline-arguments"},"Commandline Arguments"),Object(o.b)("p",null,"The following arguments are available for both ",Object(o.b)("inlineCode",{parentName:"p"},"lstart")," and ",Object(o.b)("inlineCode",{parentName:"p"},"vstart"),"."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"--tmux-attached")," - this runs machines with USE_TMUX=TRUE and TMUX_OPEN_TERMS=TRUE (see netkit.conf section above for what these variables do)"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"--tmux-detached")," - this runs machines with USE_TMUX=TRUE and TMUX_OPEN_TERMS=FALSE (see netkit.conf section above for what these variables do)"),Object(o.b)("h2",{id:"how-use-tmux-with-netkit-jh"},"How Use Tmux with Netkit-JH"),Object(o.b)("h3",{id:"connecting-to-a-machine"},"Connecting To A Machine"),Object(o.b)("p",null,"First check what machines you can connect to:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"$ vconnect -l\n\na: 1 windows (created Thu Jan  7 14:09:07 2021)\n")),Object(o.b)("p",null,"We see that there is a tmux session for machine a. We can connect to it with:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"$ vconnect -m a --terminal\n")),Object(o.b)("p",null,"Now a new terminal should appear (the terminal specified by TERM_TYPE in netkit.conf). If you want to connect in the current terminal / shell (necessary if you're running headless) you can omit the ",Object(o.b)("inlineCode",{parentName:"p"},"--terminal"),"."),Object(o.b)("p",null,"If you have ",Object(o.b)("inlineCode",{parentName:"p"},"TMUX_OPEN_TERMS=TRUE")," in your netkit.conf, or pass ",Object(o.b)("inlineCode",{parentName:"p"},"--tmux-attached")," to ",Object(o.b)("inlineCode",{parentName:"p"},"lstart")," or ",Object(o.b)("inlineCode",{parentName:"p"},"vstart"),", you shouldn't have to connect to the machine manually. However you might want to disconnect after a terminal has auto-opened, and then connect to it again later - the above is how you would do this."),Object(o.b)("h3",{id:"general-tmux-use"},"General Tmux Use"),Object(o.b)("p",null,"In tmux, most keyboard shortcuts require you to hit a 'leader' key, followed by a key specific to the shortcut. The current leader key we have configured is ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"t"),". This means to run a tmux shortcut you would do ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"t"),", then press the key for the command."),Object(o.b)("p",null,"Where you see ",Object(o.b)("kbd",null,"leader"),", remember this means ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"t"),", unless you're using a custom tmux config."),Object(o.b)("div",{className:"admonition admonition-info alert alert--info"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"Here we've used ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"t")," for the leader key, as ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"b")," is the default for tmux, and some people might want to connect to a machine's tmux session within a tmux session on the host, e.g. having different machines in different panes. Another popular leader key is ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"a"),", which is also the default leader key for GNU Screen - meaning this would also conflict. We thought ",Object(o.b)("kbd",null,"ctrl")," + ",Object(o.b)("kbd",null,"t")," would have the least conflicts and therefore be a good leader key, but if you want to propose a better default please open an issue on GitHub!"))),Object(o.b)("h3",{id:"disconnecting-from-a-machine"},"Disconnecting from a machine"),Object(o.b)("p",null,"To disconnect from a tmux session, press ",Object(o.b)("kbd",null,"leader")," then ",Object(o.b)("kbd",null,"d"),". This will disconnect you from the session without closing it,\nso you can reconnect at any point while the machine is running."),Object(o.b)("h3",{id:"show-help-message"},"Show Help Message"),Object(o.b)("p",null,"There is a simple help file, with similar information to what is in this docs, which you can access within a Netkit Tmux session by pressing ",Object(o.b)("kbd",null,"leader")," then ",Object(o.b)("kbd",null,"h")),Object(o.b)("h3",{id:"the-netkit-vm-pane"},"The Netkit VM Pane"),Object(o.b)("p",null,"The Netkit VM will run under window 'netkit-vm' pane '0'. If you are not on this pane all commands will go to the host not the Netkit machine!! "),Object(o.b)("p",null,"To help you, the status bar should change colour depending on what pane you are in. By default this is purple if you are in a netkit vm and blue if you are in a host shell."),Object(o.b)("h3",{id:"creating-new-panes"},"Creating New Panes"),Object(o.b)("p",null,"To create a new pane do ",Object(o.b)("kbd",null,"leader")," followed by ",Object(o.b)("kbd",null,"%")," - this will create a vertical split."),Object(o.b)("p",null,"If you want a horizontal split instead, you can use ",Object(o.b)("kbd",null,"leader")," followed by ",Object(o.b)("kbd",null,'"')),Object(o.b)("p",null,"To move between panes you hit ",Object(o.b)("kbd",null,"leader")," followed by ",Object(o.b)("kbd",null,"arrow-key")," - with the arrow key depending on the direction you want to move from the current active pane. You also may be able to click on a with your mouse to move to it (depending on your terminal). "),Object(o.b)("p",null,"If you have made a split / splits, you may want to zoom into a specific pane. By hitting ",Object(o.b)("kbd",null,"leader")," followed by ",Object(o.b)("kbd",null,"z")," you will zoom into the active pane (the active pane will fill the whole window). To zoom out, just do this again."),Object(o.b)("h3",{id:"creating-new-windows"},"Creating new windows"),Object(o.b)("p",null,"To create a new window, do ",Object(o.b)("kbd",null,"leader")," followed by ",Object(o.b)("kbd",null,"c"),". This will create a window to the right of the current window. "),Object(o.b)("p",null,"To move between windows you can use ",Object(o.b)("kbd",null,"leader")," ",Object(o.b)("kbd",null,"n")," to go to the next window, or ",Object(o.b)("kbd",null,"leader")," ",Object(o.b)("kbd",null,"p")," to go to the previous."),Object(o.b)("h3",{id:"capturing-output"},"Capturing Output"),Object(o.b)("p",null,"Note the following will save the active pane, so if you want to capture the machine log, make sure you are on the netkit pane!"),Object(o.b)("p",null,"To save output to /tmp hit ",Object(o.b)("kbd",null,"leader")," then ",Object(o.b)("kbd",null,"s")," (lower case 's')."),Object(o.b)("p",null,"To save with a custom filename, use ",Object(o.b)("kbd",null,"leader")," ",Object(o.b)("kbd",null,"S")," (capital 'S')."),Object(o.b)("h3",{id:"netkit-machine-shutdown--failure"},"Netkit Machine Shutdown / Failure"),Object(o.b)("p",null,"When a machine shuts down it can be due to errors that we need to look at. In order to preserve the machine output, the tmux session will get renamed to MACHINENAME-dead, and the netkit pane will remain open."),Object(o.b)("h2",{id:"advanced"},"Advanced"),Object(o.b)("p",null,"If you want to automate starting labs with tmux, take a look at the ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/blog/using-tmuxinator-with-netkit"}),"blog post")," about tmuxinator."),Object(o.b)("p",null,"You can start using tmux with netkit without having to learn lots about tmux to begin with, but tmux can be more powerful if you learn more about windows, panes, shortcuts etc. Once you have a basic understanding of tmux you might find the following resources useful for getting a deeper understanding:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Daniel Miessler - Tactical Tmux ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://danielmiessler.com/study/tmux/"}),"link")),Object(o.b)("li",{parentName:"ul"},"The Valuable Dev - A Detailed tmux Walkthrough to Boost Your Productivity ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://thevaluable.dev/tmux-boost-productivity-terminal/"}),"link")),Object(o.b)("li",{parentName:"ul"},"Tony Narlock - The Tao of Tmux ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://leanpub.com/the-tao-of-tmux/read"}),"link"))))}d.isMDXComponent=!0},194:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u=i.a.createContext({}),s=function(e){var t=i.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},b=function(e){var t=s(e.components);return i.a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},h=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),b=s(n),h=a,m=b["".concat(l,".").concat(h)]||b[h]||d[h]||o;return n?i.a.createElement(m,r(r({ref:t},u),{},{components:n})):i.a.createElement(m,r({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=h;var r={};for(var c in t)hasOwnProperty.call(t,c)&&(r[c]=t[c]);r.originalType=e,r.mdxType="string"==typeof e?e:a,l[1]=r;for(var u=2;u<o;u++)l[u]=n[u];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},195:function(e,t,n){"use strict";function a(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}t.a=function(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(i&&(i+=" "),i+=t);return i}},199:function(e,t,n){"use strict";var a=n(0),i=n(200);t.a=function(){const e=Object(a.useContext)(i.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},200:function(e,t,n){"use strict";var a=n(0);const i=Object(a.createContext)(void 0);t.a=i},202:function(e,t,n){"use strict";var a=n(0),i=n.n(a),o=n(199),l=n(195),r=n(55),c=n.n(r);const u=37,s=39;t.a=function(e){const{lazy:t,block:n,defaultValue:r,values:b,groupId:d,className:h}=e,{tabGroupChoices:m,setTabGroupChoices:p}=Object(o.a)(),[f,O]=Object(a.useState)(r),j=a.Children.toArray(e.children);if(null!=d){const e=m[d];null!=e&&e!==f&&b.some((t=>t.value===e))&&O(e)}const w=e=>{O(e),null!=d&&p(d,e)},v=[];return i.a.createElement("div",null,i.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(l.a)("tabs",{"tabs--block":n},h)},b.map((({value:e,label:t})=>i.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":f===e,className:Object(l.a)("tabs__item",c.a.tabItem,{"tabs__item--active":f===e}),key:e,ref:e=>v.push(e),onKeyDown:e=>{((e,t,n)=>{switch(n.keyCode){case s:((e,t)=>{const n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()})(e,t);break;case u:((e,t)=>{const n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()})(e,t)}})(v,e.target,e)},onFocus:()=>w(e),onClick:()=>{w(e)}},t)))),t?Object(a.cloneElement)(j.filter((e=>e.props.value===f))[0],{className:"margin-vert--md"}):i.a.createElement("div",{className:"margin-vert--md"},j.map(((e,t)=>Object(a.cloneElement)(e,{key:t,hidden:e.props.value!==f})))))}},203:function(e,t,n){"use strict";var a=n(3),i=n(0),o=n.n(i);t.a=function({children:e,hidden:t,className:n}){return o.a.createElement("div",Object(a.a)({role:"tabpanel"},{hidden:t,className:n}),e)}}}]);