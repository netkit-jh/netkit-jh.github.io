(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{149:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=a.a.createContext({}),p=function(e){var t=a.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=p(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=p(n),b=r,h=u["".concat(o,".").concat(b)]||u[b]||d[b]||i;return n?a.a.createElement(h,c(c({ref:t},s),{},{components:n})):a.a.createElement(h,c({ref:t},s))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=b;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var s=2;s<i;s++)o[s]=n[s];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},75:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return p}));var r=n(3),a=n(7),i=(n(0),n(149)),o={id:"kernelpatches",title:"Creating Kernel Patches",sidebar_label:"Creating Kernel Patches"},c={unversionedId:"dev/guides/kernelpatches",id:"version-1.0.0/dev/guides/kernelpatches",isDocsHomePage:!1,title:"Creating Kernel Patches",description:"Creating Kernel Patches for Netkit-JH",source:"@site/versioned_docs/version-1.0.0/dev/guides/kernelpatches.md",slug:"/dev/guides/kernelpatches",permalink:"/docs/1.0.0/dev/guides/kernelpatches",editUrl:"https://github.com/netkit-jh/netkit-jh.github.io/edit/main/versioned_docs/version-1.0.0/dev/guides/kernelpatches.md",version:"1.0.0",sidebar_label:"Creating Kernel Patches",sidebar:"version-1.0.0/someSidebar",previous:{title:"Installing Additional Packages",permalink:"/docs/1.0.0/dev/guides/fspackages"},next:{title:"Creating Netkit Test Labs",permalink:"/docs/1.0.0/dev/guides/creatingtests"}},l=[{value:"Creating Kernel Patches for Netkit-JH",id:"creating-kernel-patches-for-netkit-jh",children:[]}],s={toc:l};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"creating-kernel-patches-for-netkit-jh"},"Creating Kernel Patches for Netkit-JH"),Object(i.b)("p",null,"Netkit uses a few kernel patches to apply changes to the kernel before being built. These kernel patches add additional functionality to the UML kernel to assist the running of Netkit. One example of a kernel patch is the addition of random MAC addresses assigned to network interfaces, created from the machine's name and name of the network interface, making MAC address collisions very rare."),Object(i.b)("p",null,"To create kernel patches, firstly create two copies of the Linux kernel source code. To retrieve this source code, navigate to ",Object(i.b)("inlineCode",{parentName:"p"},"netkit-jh-build/kernel/Makefile")," and use the URL available ",Object(i.b)("inlineCode",{parentName:"p"},"KERNEL_URL"),"."),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{}),"$ wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.10.4.tar.xz\n$ tar xf linux-5.10.4.tar.xz\n$ mv linux-source-5.10.4 a\n$ cp a b\n")),Object(i.b)("p",null,"Now there is two folders with identical source code. Modify the source code within a with whatever changes are required. Once you have modified the code, run this command to produce a patch file:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{}),"$ diff -urpN a b > 93-tutorial-patch.patch\n")),Object(i.b)("p",null,"Once you have a .patch file, move it to ",Object(i.b)("inlineCode",{parentName:"p"},"netkit-jh-build/kernel/patches/")," and name it appropiately. Also add this file name to the ",Object(i.b)("inlineCode",{parentName:"p"},"series")," file."),Object(i.b)("p",null,"Now you can build as normal. If all goes well, you should see something like this:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{}),"Applying patch /home/debian/netkit-jh-build/kernel/build/user-mode-linux-5.9um1/debian/patches/93-tutorial-patch.patch\npatching file arch/um/os-Linux/umid.c\n")))}p.isMDXComponent=!0}}]);